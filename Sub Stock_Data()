Sub StockData()

        ' Declaring variables
        Dim ws As Worksheet
        Dim Ticker_Symbol As String
        Dim Open_Price As Double
        Dim Close_Price As Double
        Dim Yearly_Change As Double
        Dim Percent_Change As Double
        Dim Total_Stock_V As Double
        Dim STR As Integer
        Dim i As Long
        Dim j As Long
        Dim LastRow As Long
        Dim RowCount As Long
        
        ' Loop through all sheet
        For Each ws In Worksheet
        
        
            ' Summary title
            ws.Cells(1, "I").Value = "Ticker"
            ws.Cells(1, "J").Value = "Yearly Change"
            ws.Cells(1, "K").Value = "Percent Change"
            ws.Cells(1, "L").Value = "Total Stock Volume"
        
            LastRow = ws.Cells(Rows.Count, "A").End(xlUp).Row
            STR = 2
            First_Row = 2
            Total_Stock_V = 0
        
            For i = 2 To LastRow
            
                Open_Price = ws.Cells(First_Row, 3).Value
                Total_Stock_V = Total_Stock_V + ws.Cells(i + 1, 7).Value
                
                
            If ws.Cells(i + 1, 1).Value <> Cells(i, 1).Value Then
               
                ' Find all values
                Ticker_Symbol = ws.Cells(i, 1).Value
                Close_Price = ws.Cells(i, 6).Value
                Yearly_Change = Close_Price - Open_Price
                    For
                Cells(R, 9).Value = Ticker_Symbol
                Open_Price = Cells(i, 3).Value
                Close_Price = Cells(i, 6).Value
                Yearly_Change = Close_Price - Open_Price
                Cells(R, 10).Value = Yearly_Change
                
                ' Find the value of Percent Change
                If (Open_Price = 0 And Close_Price = 0) Then
                    Percent_Change = 0
                ElseIf (Open_Price = 0 And Close_Price <> 0) Then
                    Percent_Change = 1
                Else
                    Percent_Change = Yearly_Change / Open_Price
                    Cells(R, 11).Value = Percent_Change
                    Cells(R, 11).NumberFormat = "0.00%"
                End If
                ' Find the value of Total Stock Volumn
                Vol = Vol + Cells(i, 7).Value
                Cells(R, 12).Value = Vol
                ' Set a new value for Open Price
                Open_Price = Cells(i + 1, 3)
                ' Set a value for Vol
                Vol = 0
            'if cells are the same ticker
            Else
                Vol = Vol + Cells(i, 7).Value
            End If
        Next i
        
        ' Find the Last Row of Yearly Change in each ws
        XLastRow = Cells(Row.Count, 9).End(xlUp).Row
        ' Fix the Cell Colors
        For j = 2 To XLastRow
            If (Cells(j, 10).Value > 0 Or Cells(j, 10).Value = 0) Then
                Cells(j, 10).Interior.ColorIndex = 10
            ElseIf Cells(j, 10).Value < 0 Then
                Cells(j, 10).Interior.ColorIndex = 3
            End If
        Next j
        
    Next ws
        
End Sub
